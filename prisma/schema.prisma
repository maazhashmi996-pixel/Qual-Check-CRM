// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

enum Role {
  STUDENT
  ADMIN
}

enum RequestStatus {
  SUBMITTED
  IN_PROGRESS
  AWAITING_DOCUMENTS
  COMPLETED
  REJECTED
}

model User {
  id              String   @id @default(auto()) @map("_id") @db.ObjectId
  email           String   @unique
  password        String
  name            String
  role            Role     @default(STUDENT)
  isApproved      Boolean  @default(false)
  createdAt       DateTime @default(now())
  requests        VerificationRequest[]
}

model VerificationRequest {
  id                String        @id @default(auto()) @map("_id") @db.ObjectId
  studentId         String        @db.ObjectId
  student           User          @relation(fields: [studentId], references: [id])
  serviceType       String
  status            RequestStatus @default(SUBMITTED)
  
  fullName          String
  universityName    String
  degreeTitle       String
  graduationYear    Int
  registrationNo    String
  
  degreeDoc         String
  transcriptDoc     String
  passportDoc       String
  
  verifiedReportUrl String?
  accessCode        String?       @unique
  
  isPaid            Boolean       @default(false)
  createdAt         DateTime      @default(now())
}